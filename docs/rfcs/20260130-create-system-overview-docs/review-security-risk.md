## Security & Risk Reviewer によるレビュー結果

### 1. 判定 (Decision)

- **Status**: Approve

**判定基準:** P0 が1件以上存在する場合は Request Changes とする。P0 が0件の場合は Approve とする。

### 2. 良い点 (Strengths)

- **セクション 5.1 既存ドキュメントの内容マッピング**: 移行元と移行先の対応表が網羅的に定義されており、情報の漏れや重複が発生するリスクを低減している。移行作業の検証可能性が高い。
- **セクション 7.4 マイグレーションと後方互換性**: 旧ドキュメントへの参照を持つファイル（`ops.md` 等）の更新を明示的にスコープに含めている。ロールバック手段（Git revert）も明記されており、移行失敗時の復旧方針が明確である。
- **セクション 6 代替案の検討**: 3 案を比較し、個人プロジェクトという特性を踏まえて段階的移行（案C）を不採用とした判断は合理的である。移行期間中の重複ドキュメント共存リスクを排除している。
- **セクション 3 やらないこと**: コード変更を明示的にスコープ外としており、ドキュメント変更に伴う意図しないシステム動作変更のリスクがない。

### 3. 指摘事項 (Issues)

#### Severity 定義

| Severity | 定義 |
| :--- | :--- |
| **P0 (Blocker)** | 修正必須。論理的欠陥、仕様漏れ、重大なリスク、回答必須の質問 |
| **P1 (Nit)** | 提案。より良い手法、軽微な懸念、参考情報 |

#### 指摘一覧

**P0**: 該当なし

**[P1-1] 新ドキュメントにおける機密情報の記載方針**
- **対象セクション**: 5.2 新ドキュメントの構成 > `docs/api-overview.md`
- **内容**: `api-overview.md` の「設定インターフェース」セクションで環境変数一覧を記載する設計となっている。既存の `spec.md` と同様にプレースホルダー値や変数名のみの記載であれば問題ないが、移行作業時に実際の API キーや SMTP パスワード等の機密値を誤って記載するリスクが存在する。ドキュメントのみの変更であるためシステム上のセキュリティ脆弱性には該当しないが、Git リポジトリに機密情報がコミットされた場合、履歴からの完全削除には `git filter-branch` 等の追加作業が必要となる。
- **修正の期待値**: 実装時に、環境変数セクションには変数名・説明・デフォルト値のみを記載し、実際の値を含めないことを実装フェーズで確認する運用を推奨する。既存の `spec.md` の記載形式（変数名と説明のみのテーブル）を踏襲すれば十分である。

**[P1-2] `ops.md` 内の旧ドキュメント参照の網羅的確認**
- **対象セクション**: 5.3 既存ファイルの削除 / 7.4 マイグレーションと後方互換性
- **内容**: RFC では `ops.md` 内の旧ドキュメント参照を確認・更新する旨を記載しているが、確認対象が `ops.md` に限定されている。実際にコードベースを調査したところ、`*.ts`、`*.js`、`*.sh`、`*.yaml` 等のソースファイルやスクリプトには `arch.md` / `spec.md` への参照は存在しなかった。現時点では `ops.md` のみの確認で十分であるが、RFC の記述としては「`docs/` 配下およびプロジェクトルートの設定ファイル」のように確認範囲を明示するとより堅実である。
- **修正の期待値**: セクション 7.4 または実装計画のフェーズ 2 において、参照確認の対象範囲を「`docs/ops.md` を含むリポジトリ内のすべてのファイル」と明示することを推奨する。ただし、現状では `ops.md` 以外に参照が存在しないことを確認済みであり、実質的なリスクは低い。

**[P1-3] `.env.example` に記載されている `COPY_PAGE_BASE_URL` の反映漏れ**
- **対象セクション**: 5.2 新ドキュメントの構成 > `docs/api-overview.md` > 設定インターフェース
- **内容**: `.env.example` には `COPY_PAGE_BASE_URL`（Copy Page Server 用のベース URL）が定義されているが、既存の `spec.md` にはこの変数が記載されておらず、RFC の `api-overview.md` 設計にも明示的な言及がない。RFC のセクション 3 にて「コードベース調査に基づく最新情報で内容を補完する」を目的に掲げているため、この変数を新ドキュメントに反映すべきである。直接的なセキュリティリスクではないが、Web サーバーのベース URL はネットワーク構成に関わる情報であり、ドキュメントに記載されることでインターフェース設計の全体像が明確になる。
- **修正の期待値**: 実装フェーズにおいて、`api-overview.md` の環境変数一覧に `COPY_PAGE_BASE_URL` を含めることを推奨する。Web サーバーエンドポイントセクションとの関連も明記すると、インターフェース設計の理解に資する。
