## Approach Reviewer によるレビュー結果

### 1. 判定 (Decision)

- **Status**: Request Changes

**判定基準:** P0 が1件以上存在するため Request Changes とする。

### 2. 良い点 (Strengths)

- **セクション2（背景・動機）**: 既存ドキュメントと CLAUDE.md 規約との不一致を具体的に列挙しており、RFC の必要性の根拠が明確である。`arch.md` にドメインモデル要素が混在している点、`spec.md` がインターフェースとドメインモデルの境界を曖昧にしている点など、課題の特定が正確である。
- **セクション5.1（内容マッピング）**: 既存ドキュメントの各セクションを新ドキュメントへ配置するマッピング表が網羅的であり、移行の抜け漏れ防止に有効である。
- **セクション6（代替案の検討）**: 3案を比較検討し、個人プロジェクトという文脈を踏まえて案Aを選定した理由が論理的である。案Bの Git 履歴保持の実益が薄い点、案Cの移行期間が不要な点の判断は妥当である。
- **セクション3（Goals & Non-Goals）**: `ops.md` をスコープ外とする判断は、運用ガイドとシステム概要ドキュメントの目的差異に基づいており妥当である。コード変更を含まないと明言することでスコープが明確に制御されている。

### 3. 指摘事項 (Issues)

#### Severity 定義

| Severity | 定義 |
| :--- | :--- |
| **P0 (Blocker)** | 修正必須。論理的欠陥、仕様漏れ、重大なリスク、回答必須の質問 |
| **P1 (Nit)** | 提案。より良い手法、軽微な懸念、参考情報 |

#### 指摘一覧

**[P0-1] 前提条件「既存ドキュメントがコードベースと整合していること」は偽である**
- **対象セクション**: セクション4（前提条件・依存関係）
- **内容**: 「既存ドキュメント（`arch.md`・`spec.md`・`ops.md`）の内容が現行コードベースと整合していること」を前提条件としているが、実際には `spec.md` のデータモデルが現行コードベースと大幅に乖離している。`spec.md` は `books` テーブルのカラムを `isbn13, title, authors, delivered, delivered_at, job_name` と記載しているが、現行スキーマ（Ver2.0）は `isbn13, title, authors_json, publisher, published_date, description, cover_url, links_json, source, first_seen_at, last_seen_at, last_delivered_at` である。`delivered`（boolean フラグ）は `last_delivered_at`（タイムスタンプ）に置き換えられ、`job_name` カラムは `books` テーブルから削除されている。この前提が偽であるにもかかわらず、Goal に「既存ドキュメントの有用な情報を漏れなく新ドキュメントへ移行する」と記載されている。前提の誤りが移行方針に影響を与え、旧ドキュメントの陳腐化した情報をそのまま新ドキュメントに転記するリスクがある。
- **修正の期待値**: 前提条件を「既存ドキュメントの内容は現行コードベースと乖離している可能性がある」に修正し、Goal の「漏れなく移行する」を「コードベース調査に基づき正確な情報で新ドキュメントを作成する。既存ドキュメントは参考情報として扱い、陳腐化した記述はコードベースの実装に基づいて更新する」に改めること。セクション9の実装計画フェーズ1のステップ1（コードベース調査）はこの問題を部分的に緩和しているが、前提とGoalの記述が矛盾しているため明示的な修正が必要である。

**[P0-2] domain-model.md の設計からドメイン概念の重大な欠落**
- **対象セクション**: セクション5.2（新ドキュメントの構成 > `docs/domain-model.md`）
- **内容**: ドメイン概念の列挙が「書籍 (Book)、ジョブ (Job)、配信 (Delivery)、クォータ (Quota)、カーソル (Cursor)」の5概念のみであるが、現行コードベースには Ver3.0 で追加された Prompt（プロンプト）および PromptToken（プロンプトトークン）というドメイン概念が存在する。`prompts` テーブル（isbn13, prompt_text, created_at）と `prompt_tokens` テーブル（token, prompt_id, expires_at, created_at）が DB スキーマに定義されており、Web サーバー経由でのプロンプト閲覧という独立したユースケースを支えている。また、データ永続化セクションでも `books` と `collect_cursor` のみ言及し、`deliveries`, `delivery_items`, `job_state`, `api_usage`, `prompts`, `prompt_tokens` の6テーブルが「その他テーブル — コードベース調査に基づき補完」と曖昧に扱われている。規約の目的である「ドメイン概念と関係、業務ルール・制約、状態遷移、データ永続化（DB設計）」の把握に対し、主要テーブルの過半数が設計段階で考慮外となっている。
- **修正の期待値**: ドメイン概念にプロンプト (Prompt) およびプロンプトトークン (PromptToken) を追加すること。データ永続化セクションで全8テーブル（books, deliveries, delivery_items, job_state, api_usage, prompts, prompt_tokens, collect_cursor）の構成を明示的に記載すること。「その他テーブル — コードベース調査に基づき補完」という曖昧な記述を除去し、設計段階で全テーブルを列挙すること。

**[P1-1] api-overview.md の Web サーバーエンドポイント記述が不正確**
- **対象セクション**: セクション5.2（新ドキュメントの構成 > `docs/api-overview.md`）
- **内容**: 「/prompt 等のエンドポイント一覧」と記載されているが、実際の Web サーバーのルーティングは `GET /`（ヘルスチェック）および `GET /p/:token`（プロンプト Copy ページ）である。`/prompt` というエンドポイントは存在しない。設計ドキュメントの目次レベルとはいえ、存在しないエンドポイント名を記載すると実装時に誤解を招く。
- **修正の期待値**: エンドポイント記述を `GET /`（ヘルスチェック）と `GET /p/:token`（プロンプト Copy ページ）に修正すること。

**[P1-2] architecture.md のディレクトリ構成が src/ 配下のみ言及で不十分**
- **対象セクション**: セクション5.2（新ドキュメントの構成 > `docs/architecture.md`）
- **内容**: ディレクトリ構成セクションの説明が「src/ 配下のモジュール構造と責務」のみであるが、CLAUDE.md 規約では「ディレクトリ構成」に加えて「レイヤー構造」「依存関係」も記載内容として定義されている。また既存の `arch.md` のディレクトリ構成は `config/`, `data/`, `.env`, `dist/` 等のプロジェクトルート構造を含んでいる。新ドキュメントでも `src/` 内部だけでなくプロジェクト全体のディレクトリ構成を記載すべきである。
- **修正の期待値**: ディレクトリ構成の記述範囲を「プロジェクトルートおよび src/ 配下のモジュール構造と責務」に拡張し、CLAUDE.md 規約の「レイヤー構造」「依存関係」の観点を明示的に含めること。

**[P1-3] spec.md の「非目的」セクションのマッピング先が不明確**
- **対象セクション**: セクション5.1（既存ドキュメントの内容マッピング）
- **内容**: マッピング表では `spec.md > 目的・非目的・ユースケース` を一括して `architecture.md`（概要として）に移行する計画であるが、`spec.md` の「非目的」セクションには「書籍の全文検索・閲覧機能」「複数ユーザーへの同時配信」「リアルタイム通知」が記載されている。これらはシステムのスコープ定義として有用であるが、`architecture.md` の目次案にはこれを受ける明示的なセクションがない。マッピング先が曖昧なまま実装に入ると、有用な情報が脱落する可能性がある。
- **修正の期待値**: `architecture.md` の「システム概要」セクション内に「スコープ（目的と非目的）」のサブセクションを明示するか、マッピング表で具体的な配置先セクションを補記すること。
